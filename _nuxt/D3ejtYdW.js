import{h as Q,j as ee,u as le,M as ae}from"./CN5EsVXz.js";import{d as f,a6 as w,a7 as V,k as y,K as x,A as v,am as $,J as i,E as O,ar as C,as as j,B as N,a3 as T,_ as P,z as _,D as m,at as H,au as U,av as q,M as K,ac as te,I as oe,ae as Y,af as G,s as ne,a9 as ue,al as de,aw as c,ax as me,ay as ie,az as se,aA as re,aB as ce,aC as J,aD as pe,aE as ve,aF as fe,L as Ve,ak as ye,X as L,U as Te,a1 as _e,G as be}from"#entry";import{_ as Z}from"./Dq2_-K6K.js";import{_ as R}from"./CWJcnSqZ.js";import"./D61i_Jxt.js";const Ie=["id","label","step","min","max","onClick"],ke=f({__name:"InputTime",props:w({id:{default:()=>{}},flat:{type:Boolean},min:{default:null},max:{default:null},autofocus:{type:Boolean},clearable:{type:Boolean},precision:{default:"minutes"},step:{default:5},overnight:{type:Boolean},placeholder:{},label:{}},{modelValue:{default:null},modelModifiers:{}}),emits:["update:modelValue"],setup(a){const e=new Map([["hours",3600],["minutes",60],["seconds",1]]),n=new Map([["hours",2],["minutes",5],["seconds",8]]),o=V(a,"modelValue"),l=y(()=>({label:a.label,placeholder:a.placeholder}));function t(g){document.getElementById(g)?.showPicker()}const u=y({get:()=>o.value===null||o.value instanceof Temporal.PlainDate?null:(o.value instanceof Temporal.PlainDateTime?o.value.toPlainTime():o.value).toJSON(),set:g=>o.value=g?o.value instanceof Temporal.PlainDateTime?o.value.withPlainTime(Temporal.PlainTime.from(g)):o.value instanceof Temporal.PlainDate?o.value.toPlainDateTime(Temporal.PlainTime.from(g)):Temporal.PlainTime.from(g):o.value instanceof Temporal.PlainDateTime?o.value.toPlainDate():o.value instanceof Temporal.PlainDate?o.value:null}),d=y(()=>e.get(a.precision)*a.step),s=y(()=>n.get(a.precision)),r=y(()=>(a.min instanceof k?a.min.toPlainTime():a.min)?.toJSON().slice(0,s.value)),p=y(()=>(a.max instanceof k?a.max.toPlainTime():a.max)?.toJSON().slice(0,s.value)),b=new Intl.DateTimeFormat(void 0,{hour:"numeric",minute:"numeric",second:void 0,timeZone:Temporal.Now.timeZoneId()}),k=Temporal.PlainDateTime;function D(){a.clearable&&(u.value=null)}return(g,I)=>{const A=R;return v(),x(A,$({id:a.id,"model-value":i(u)!==null&&o.value!==null?i(b).format(o.value):"","icon-left":a.overnight?"time-overnight":"time","icon-right":a.clearable&&i(u)!==null?"cancel":void 0,"icon-click-right":D},i(l),{flat:a.flat,autofocus:a.autofocus,readonly:"","no-outline":"",onEnter:t,onDelete:D,onFocus:I[1]||(I[1]=h=>h())}),{default:O(({id:h})=>[C(N("input",{id:h,"onUpdate:modelValue":I[0]||(I[0]=F=>T(u)?u.value=F:null),label:a.label,type:"time",class:"absolute inset-0 opacity-0",step:i(d),min:i(r),max:i(p),tabindex:"-1",onClick:F=>t(h)},null,8,Ie),[[j,i(u)]])]),_:1},16,["id","model-value","icon-left","icon-right","flat","autofocus"])}}}),ge=Object.assign(P(ke,[["__scopeId","data-v-e9f1734b"]]),{__name:"AInputTime"}),xe={class:"flex justify-center gap-2"},he=f({__name:"TimeInterval",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(a){const e=V(a,"modelValue");return(n,o)=>{const l=ge;return v(),_("div",xe,[m(l,{modelValue:e.value.timeStart,"onUpdate:modelValue":o[0]||(o[0]=t=>e.value.timeStart=t),placeholder:""},null,8,["modelValue"]),m(l,{modelValue:e.value.timeEnd,"onUpdate:modelValue":o[1]||(o[1]=t=>e.value.timeEnd=t),placeholder:""},null,8,["modelValue"])])}}}),Oe=Object.assign(he,{__name:"OEditorScheduleTimeInterval"}),Ee={class:"flex items-center justify-center gap-2 pt-2"},{PlainTime:B}=Temporal,Me=1440,S=B.from("00:00"),De=B.from("00:05"),Se=B.from("23:55"),W=new U(S,S),we=f({__name:"TimeIntervals",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(a){const e=V(a,"modelValue");H(e,r=>{r.length>0||(e.value=[W.clone()])});const n=y(()=>{const r=e.value[0];return r!==void 0&&Temporal.PlainTime.compare(De,r.timeStart)<0});function o(){const r=e.value[0];e.value.unshift(new U(S,r.timeStart.add({minutes:-5})))}const l=y(()=>{const r=e.value.at(-1);return r===void 0||!r.isOvernight&&Temporal.PlainTime.compare(r.timeEnd,Se)<0});function t(){const r=e.value.at(-1);e.value.push(new U(r.timeEnd.add({minutes:5}),S))}function u(r){const[p]=e.value.splice(r,1);e.value.length===0&&e.value.push(W.clone(p.key))}function d(r){const p=e.value[r];e.value.splice(r,1,...p.split())}function s(r){return e.value[r].canSplit()}return(r,p)=>{const b=K,k=q,D=Oe,g=Q;return v(),x(g,{class:"flex flex-col",label:"Time intervals"},{default:O(()=>[m(k,{show:i(n)},{default:O(()=>[m(b,{icon:"add",class:"aspect-auto! w-full",onClick:o})]),_:1},8,["show"]),m(k,{items:e.value},{item:O(({index:I,item:A})=>[N("div",Ee,[m(b,{icon:"remove",flat:"",disabled:A.durationMinutes===Me,onClick:h=>u(I)},null,8,["disabled","onClick"]),m(D,{modelValue:e.value[I],"onUpdate:modelValue":h=>e.value[I]=h},null,8,["modelValue","onUpdate:modelValue"]),m(b,{icon:"split",flat:"",disabled:!s(I),onClick:h=>d(I)},null,8,["disabled","onClick"])])]),_:1},8,["items"]),m(k,{show:i(l)},{default:O(()=>[m(b,{icon:"add",class:"aspect-auto! w-full",onClick:t})]),_:1},8,["show"])]),_:1})}}}),Ne=Object.assign(we,{__name:"OEditorScheduleTimeIntervals"}),Ae=f({__name:"InputNumber",props:w({id:{},autofocus:{type:Boolean},min:{default:()=>-1/0},max:{default:()=>1/0},clearModel:{default:0},clearText:{default:""},placeholder:{},label:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(a){const e=V(a,"modelValue"),n=y(()=>({label:a.label,placeholder:a.placeholder||a.clearText||`${a.clearModel}`})),o=y({get:()=>`${e.value===a.clearModel?a.clearText:e.value}`,set:l=>{let t=Number(l);(t===0||isNaN(t))&&(t=a.clearModel),e.value=ee(a.min,a.max,t)}});return(l,t)=>{const u=R;return v(),x(u,$({id:a.id,modelValue:i(o),"onUpdate:modelValue":t[0]||(t[0]=d=>T(o)?o.value=d:null),"icon-right":e.value!==a.clearModel?"cancel":void 0,"icon-click-right":()=>o.value="",type:"number",autofocus:a.autofocus},i(n),{pattern:"[0-9]+",inputmode:"numeric","data-bright-placeholder":a.placeholder?void 0:!0}),null,16,["id","modelValue","icon-right","icon-click-right","autofocus","data-bright-placeholder"])}}}),M=Object.assign(P(Ae,[["__scopeId","data-v-10a0f31a"]]),{__name:"AInputNumber"}),Ue=["id","label","min","max","data-bright-placeholder","onClick"],$e=f({__name:"InputDate",props:w({id:{default:()=>{}},flat:{type:Boolean},min:{default:null},max:{default:null},clearModel:{},clearText:{},autofocus:{type:Boolean},placeholder:{},label:{}},{modelValue:{default:null},modelModifiers:{}}),emits:["update:modelValue"],setup(a){const e=V(a,"modelValue"),n=y(()=>({label:a.label,placeholder:a.placeholder}));function o(s){document.getElementById(s)?.showPicker()}const l=y({get:()=>e.value===null||e.value instanceof Temporal.PlainTime||a.clearModel!==void 0&&a.clearModel!==null&&!Temporal.PlainDate.compare(a.clearModel,e.value)?null:(e.value instanceof Temporal.PlainDateTime?e.value.toPlainDate():e.value).toJSON(),set:s=>e.value=s?e.value instanceof Temporal.PlainDateTime||e.value instanceof Temporal.PlainTime?Temporal.PlainDate.from(s).toPlainDateTime(e.value):Temporal.PlainDate.from(s):e.value instanceof Temporal.PlainDateTime?e.value.toPlainTime():e.value instanceof Temporal.PlainTime?e.value:null}),t=new Intl.DateTimeFormat(void 0,{hour:void 0,minute:void 0,second:void 0,day:"2-digit",month:"short",year:"numeric",timeZone:Temporal.Now.timeZoneId()}),u=Temporal.PlainDateTime;function d(){l.value=a.clearModel?.toJSON()??null}return(s,r)=>{const p=R;return v(),x(p,$({id:a.id,"model-value":i(l)!==null&&e.value!==null?i(t).format(e.value):a.clearText??"","icon-left":"date","icon-right":a.clearModel!==void 0&&i(l)!==null?"cancel":void 0,"icon-click-right":d},i(n),{flat:a.flat,autofocus:a.autofocus,readonly:"","no-outline":"",onEnter:o,onDelete:d,onFocus:r[1]||(r[1]=b=>b())}),{default:O(({id:b})=>[C(N("input",{id:b,"onUpdate:modelValue":r[0]||(r[0]=k=>T(l)?l.value=k:null),label:a.label,type:"date",class:"absolute inset-0 opacity-0",min:(a.min instanceof i(u)?a.min.toPlainDate():a.min)?.toJSON(),max:(a.max instanceof i(u)?a.max.toPlainDate():a.max)?.toJSON(),tabindex:"-1","data-bright-placeholder":a.placeholder?void 0:!0,onClick:k=>o(b)},null,8,Ue),[[j,i(l)]])]),_:1},16,["id","model-value","icon-right","flat","autofocus"])}}}),E=Object.assign(P($e,[["__scopeId","data-v-66a1a61d"]]),{__name:"AInputDate"}),Pe={class:"grid grid-cols-2 gap-2"},Ye=f({__name:"Daily",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(a){const e=V(a,"modelValue"),{Now:n}=Temporal;return(o,l)=>{const t=M,u=E;return v(),_("div",Pe,[m(t,{modelValue:e.value.occurrences,"onUpdate:modelValue":l[0]||(l[0]=d=>e.value.occurrences=d),label:"Times","clear-model":1/0,"clear-text":"Infinite"},null,8,["modelValue"]),m(t,{modelValue:e.value.interval,"onUpdate:modelValue":l[1]||(l[1]=d=>e.value.interval=d),label:"Every","clear-model":1,"clear-text":"1",min:1},null,8,["modelValue"]),m(u,{modelValue:e.value.dayFrom,"onUpdate:modelValue":l[2]||(l[2]=d=>e.value.dayFrom=d),label:"Day from","clear-model":i(n).plainDateISO(),"clear-text":"Today"},null,8,["modelValue","clear-model"]),m(u,{modelValue:e.value.dayTo,"onUpdate:modelValue":l[3]||(l[3]=d=>e.value.dayTo=d),label:"Day to","clear-model":null,"clear-text":"Forever"},null,8,["modelValue"])])}}}),Re=Object.assign(Ye,{__name:"OEditorScheduleRuleDaily"}),Be=f({__name:"Toggle",props:w({icon:{},label:{},flat:{type:Boolean},mask:{},noUnderline:{type:Boolean}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(a){const e=V(a,"modelValue"),n=a,o=y(()=>n.mask===void 0?e.value:n.mask&+e.value);function l(){e.value=n.mask===void 0?!e.value:n.mask^+e.value}return(t,u)=>{const d=K;return v(),x(d,{icon:a.icon,label:a.label,flat:a.flat,class:te(["flex items-center justify-center text-center !outline-offset-2",a.flat?[a.noUnderline?i(o)?"[--color-picked-offset:15]":"opacity-70":["after:absolute after:bottom-0 after:h-[1px] after:w-full after:rounded-full","after:bg-picked-neon after:shadow-glow after:shadow-picked-neon","after:bg-picked-pastel after:shadow-picked-pastel","after:transition-[transform,opacity] after:duration-300 after:ease-in-out",i(o)?"":"after:scale-x-0 after:opacity-0"],"text-shadow-glow-lg relative","transition-[color,filter] duration-300 ease-in-out",i(o)?["text-picked-bright shadow-picked-pastel"]:["text-picked-neon shadow-picked-pastel/0"]]:[i(o)&&"!-from-picked-pastel-30 !to-picked-pastel-30 !text-picked-deep"],i(o)&&"!-from-picked-deep-5 !to-picked-deep-5"]),role:"checkbox","aria-checked":i(o),onClick:l},{default:O(()=>[oe(t.$slots,"default")]),_:3},8,["icon","label","flat","class","aria-checked"])}}}),z=Object.assign(Be,{__name:"AToggle"}),Fe={class:"col-span-2 grid grid-cols-7 gap-2"},Le=f({__name:"Monthdays",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(a){const e=V(a,"modelValue"),n=y({get:()=>{let o=0;for(const l of e.value)o|=1<<l-1;return o},set:o=>{const l=[];for(let t=0;t<31;t++)o&1<<t&&l.push(t+1);console.log({value:o,valueNew:l}),e.value=l}});return(o,l)=>{const t=z;return v(),_("div",Fe,[(v(),_(Y,null,G(31,u=>m(t,{key:u,modelValue:i(n),"onUpdate:modelValue":l[0]||(l[0]=d=>T(n)?n.value=d:null),mask:1<<u-1,flat:"",label:`${u}`},null,8,["modelValue","mask","label"])),64))])}}}),We=Object.assign(Le,{__name:"OEditorScheduleMonthdays"}),Ce={class:"grid grid-cols-2 gap-2"},je=f({__name:"MonthlyByMonthdays",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(a){const e=V(a,"modelValue"),{Now:n}=Temporal;return(o,l)=>{const t=We,u=M,d=E;return v(),_("div",Ce,[m(t,{modelValue:e.value.monthdays,"onUpdate:modelValue":l[0]||(l[0]=s=>e.value.monthdays=s)},null,8,["modelValue"]),m(u,{modelValue:e.value.occurrences,"onUpdate:modelValue":l[1]||(l[1]=s=>e.value.occurrences=s),label:"Times","clear-model":1/0,"clear-text":"Infinite"},null,8,["modelValue"]),m(u,{modelValue:e.value.interval,"onUpdate:modelValue":l[2]||(l[2]=s=>e.value.interval=s),label:"Every","clear-model":1,"clear-text":"1",min:1},null,8,["modelValue"]),m(d,{modelValue:e.value.dayFrom,"onUpdate:modelValue":l[3]||(l[3]=s=>e.value.dayFrom=s),label:"Day from","clear-model":i(n).plainDateISO(),"clear-text":"Today"},null,8,["modelValue","clear-model"]),m(d,{modelValue:e.value.dayTo,"onUpdate:modelValue":l[4]||(l[4]=s=>e.value.dayTo=s),label:"Day to","clear-model":null,"clear-text":"Forever"},null,8,["modelValue"])])}}}),He=Object.assign(je,{__name:"OEditorScheduleRuleMonthlyByMonthdays"}),qe={class:"col-span-2 flex gap-2 px-4"},Ke=f({__name:"Weekdays",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(a){const e=V(a,"modelValue"),n=y({get:()=>{let o=0;for(const l of e.value)o|=1<<l-1;return o},set:o=>{const l=[];for(let t=0;t<7;t++)o&1<<t&&l.push(t+1);e.value=l}});return(o,l)=>{const t=z;return v(),_("div",qe,[m(t,{modelValue:i(n),"onUpdate:modelValue":l[0]||(l[0]=u=>T(n)?n.value=u:null),mask:1,flat:"",label:"Mon"},null,8,["modelValue"]),m(t,{modelValue:i(n),"onUpdate:modelValue":l[1]||(l[1]=u=>T(n)?n.value=u:null),mask:2,flat:"",label:"Tue"},null,8,["modelValue"]),m(t,{modelValue:i(n),"onUpdate:modelValue":l[2]||(l[2]=u=>T(n)?n.value=u:null),mask:4,flat:"",label:"Wed"},null,8,["modelValue"]),m(t,{modelValue:i(n),"onUpdate:modelValue":l[3]||(l[3]=u=>T(n)?n.value=u:null),mask:8,flat:"",label:"Thu"},null,8,["modelValue"]),m(t,{modelValue:i(n),"onUpdate:modelValue":l[4]||(l[4]=u=>T(n)?n.value=u:null),mask:16,flat:"",label:"Fri"},null,8,["modelValue"]),m(t,{modelValue:i(n),"onUpdate:modelValue":l[5]||(l[5]=u=>T(n)?n.value=u:null),mask:32,flat:"",label:"Sat"},null,8,["modelValue"]),m(t,{modelValue:i(n),"onUpdate:modelValue":l[6]||(l[6]=u=>T(n)?n.value=u:null),mask:64,flat:"",label:"Sun"},null,8,["modelValue"])])}}}),X=Object.assign(Ke,{__name:"OEditorScheduleWeekdays"}),Ge={class:"grid grid-cols-2 gap-2"},Je=f({__name:"MonthlyByWeekdays",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(a){const e=V(a,"modelValue"),{Now:n}=Temporal,o=new Map([[1,{id:"1",label:"First"}],[2,{id:"2",label:"Second"}],[3,{id:"3",label:"Third"}],[4,{id:"4",label:"Fourth"}],[-1,{id:"-1",label:"Last"}]]);return(l,t)=>{const u=Z,d=X,s=M,r=E;return v(),_("div",Ge,[m(u,{modelValue:e.value.weekOfMonth,"onUpdate:modelValue":t[0]||(t[0]=p=>e.value.weekOfMonth=p),items:i(o),label:"Week",class:"col-span-2"},null,8,["modelValue","items"]),m(d,{modelValue:e.value.weekdays,"onUpdate:modelValue":t[1]||(t[1]=p=>e.value.weekdays=p)},null,8,["modelValue"]),m(s,{modelValue:e.value.occurrences,"onUpdate:modelValue":t[2]||(t[2]=p=>e.value.occurrences=p),label:"Times","clear-model":1/0,"clear-text":"Infinite"},null,8,["modelValue"]),m(s,{modelValue:e.value.interval,"onUpdate:modelValue":t[3]||(t[3]=p=>e.value.interval=p),label:"Every","clear-model":1,"clear-text":"1",min:1},null,8,["modelValue"]),m(r,{modelValue:e.value.dayFrom,"onUpdate:modelValue":t[4]||(t[4]=p=>e.value.dayFrom=p),label:"Day from","clear-model":i(n).plainDateISO(),"clear-text":"Today"},null,8,["modelValue","clear-model"]),m(r,{modelValue:e.value.dayTo,"onUpdate:modelValue":t[5]||(t[5]=p=>e.value.dayTo=p),label:"Day to","clear-model":null,"clear-text":"Forever"},null,8,["modelValue"])])}}}),Ze=Object.assign(Je,{__name:"OEditorScheduleRuleMonthlyByWeekdays"}),ze=f({__name:"Once",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(a){const e=V(a,"modelValue");return(n,o)=>{const l=E;return v(),x(l,{modelValue:e.value.day,"onUpdate:modelValue":o[0]||(o[0]=t=>e.value.day=t),label:"Day"},null,8,["modelValue"])}}}),Xe=Object.assign(ze,{__name:"OEditorScheduleRuleOnce"}),Qe={class:"grid grid-cols-2 gap-2"},el=f({__name:"Weekly",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(a){const e=V(a,"modelValue"),{Now:n}=Temporal;return(o,l)=>{const t=X,u=M,d=E;return v(),_("div",Qe,[m(t,{modelValue:e.value.weekdays,"onUpdate:modelValue":l[0]||(l[0]=s=>e.value.weekdays=s)},null,8,["modelValue"]),m(u,{modelValue:e.value.occurrences,"onUpdate:modelValue":l[1]||(l[1]=s=>e.value.occurrences=s),label:"Times","clear-model":1/0,"clear-text":"Infinite"},null,8,["modelValue"]),m(u,{modelValue:e.value.interval,"onUpdate:modelValue":l[2]||(l[2]=s=>e.value.interval=s),label:"Every","clear-model":1,"clear-text":"1",min:1},null,8,["modelValue"]),m(d,{modelValue:e.value.dayFrom,"onUpdate:modelValue":l[3]||(l[3]=s=>e.value.dayFrom=s),label:"Day from","clear-model":i(n).plainDateISO(),"clear-text":"Today"},null,8,["modelValue","clear-model"]),m(d,{modelValue:e.value.dayTo,"onUpdate:modelValue":l[4]||(l[4]=s=>e.value.dayTo=s),label:"Day to","clear-model":null,"clear-text":"Forever"},null,8,["modelValue"])])}}}),ll=Object.assign(el,{__name:"OEditorScheduleRuleWeekly"}),al={class:"grid grid-cols-2 gap-2"},tl=f({__name:"Yearly",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(a){const e=V(a,"modelValue"),{Now:n}=Temporal;return(o,l)=>{const t=M,u=E;return v(),_("div",al,[m(t,{modelValue:e.value.occurrences,"onUpdate:modelValue":l[0]||(l[0]=d=>e.value.occurrences=d),label:"Times","clear-model":1/0,"clear-text":"Infinite"},null,8,["modelValue"]),m(t,{modelValue:e.value.interval,"onUpdate:modelValue":l[1]||(l[1]=d=>e.value.interval=d),label:"Every","clear-model":1,"clear-text":"1",min:1},null,8,["modelValue"]),m(u,{modelValue:e.value.dayFrom,"onUpdate:modelValue":l[2]||(l[2]=d=>e.value.dayFrom=d),label:"Day from","clear-model":i(n).plainDateISO(),"clear-text":"Today"},null,8,["modelValue","clear-model"]),m(u,{modelValue:e.value.dayTo,"onUpdate:modelValue":l[3]||(l[3]=d=>e.value.dayTo=d),label:"Day to","clear-model":null,"clear-text":"Forever"},null,8,["modelValue"])])}}}),ol=Object.assign(tl,{__name:"OEditorScheduleRuleYearly"}),nl={class:"flex flex-col gap-2"},ul=new Map([[c.ONCE,{id:c.ONCE,label:"Does not repeat"}],[c.DAILY,{id:c.DAILY,label:"Daily"}],[c.WEEKLY,{id:c.WEEKLY,label:"Weekly"}],[c.MONTHLY_BY_WEEKDAYS,{id:c.MONTHLY_BY_WEEKDAYS,label:"Monthly (by weekdays)"}],[c.MONTHLY_BY_MONTHDAYS,{id:c.MONTHLY_BY_MONTHDAYS,label:"Monthly (by monthdays)"}],[c.YEARLY,{id:c.YEARLY,label:"Yearly"}]]),dl=f({__name:"Index",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(a){const e=V(a,"modelValue"),n=ne(e.value.ruleType);ue(()=>n.value=e.value.ruleType),de(n,l=>{const t=e.value.dayFrom??Temporal.Now.plainDateISO(),u=e.value.ruleType===c.ONCE?null:e.value.dayTo,d=e.value.timeIntervals,s=e.value.key;switch(l){case c.ONCE:e.value=new pe(t,d,s);break;case c.DAILY:e.value=new J(t,u,1,1/0,d,s);break;case c.WEEKLY:e.value=new ce(t,u,1,1/0,[t.dayOfWeek],d,s);break;case c.MONTHLY_BY_WEEKDAYS:e.value=new se(t,u,1,1/0,re(t),[t.dayOfWeek],d,s);break;case c.MONTHLY_BY_MONTHDAYS:e.value=new ie(t,u,1,1/0,[t.day],d,s);break;case c.YEARLY:e.value=new me(t,u,1,1/0,d,s);break;default:throw new Error(`Unknown rule type: ${l}`)}},{flush:"sync"});const o=[{component:Xe,id:c.ONCE},{component:Re,id:c.DAILY},{component:ll,id:c.WEEKLY},{component:Ze,id:c.MONTHLY_BY_WEEKDAYS},{component:He,id:c.MONTHLY_BY_MONTHDAYS},{component:ol,id:c.YEARLY}];return(l,t)=>{const u=Z,d=q,s=Ne;return v(),_(Y,null,[m(u,{modelValue:i(n),"onUpdate:modelValue":t[0]||(t[0]=r=>T(n)?n.value=r:null),items:i(ul),icon:"repeat",label:"Repeat"},null,8,["modelValue","items"]),N("div",nl,[m(d,{items:o,filter:r=>r.id===i(n)},{item:O(({item:r})=>[(v(),x(ve(r.component),{modelValue:e.value,"onUpdate:modelValue":t[1]||(t[1]=p=>e.value=p),class:"pt-2"},null,8,["modelValue"]))]),_:1},8,["filter"]),m(s,{modelValue:e.value.timeIntervals,"onUpdate:modelValue":t[2]||(t[2]=r=>e.value.timeIntervals=r)},null,8,["modelValue"])])],64)}}}),ml=Object.assign(dl,{__name:"OEditorScheduleRule"}),il=f({__name:"Rules",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(a){const e=V(a,"modelValue");return(n,o)=>{const l=ml;return v(!0),_(Y,null,G(e.value,(t,u)=>(v(),x(l,{key:t.key,modelValue:e.value[u],"onUpdate:modelValue":d=>e.value[u]=d},null,8,["modelValue","onUpdate:modelValue"]))),128)}}}),sl=Object.assign(il,{__name:"OEditorScheduleRules"}),rl={key:0},cl=f({__name:"Index",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(a){const e=V(a,"modelValue");return H(e,n=>{n===null&&(e.value=new fe([new J(Temporal.Now.plainDateISO(),null,1,1/0,[])],[],null))}),(n,o)=>{const l=sl;return e.value?(v(),_("div",rl,[m(l,{modelValue:e.value.rules,"onUpdate:modelValue":o[0]||(o[0]=t=>e.value.rules=t)},null,8,["modelValue"]),m(l,{modelValue:e.value.exceptions,"onUpdate:modelValue":o[1]||(o[1]=t=>e.value.exceptions=t)},null,8,["modelValue"])])):Ve("",!0)}}}),pl=Object.assign(cl,{__name:"OEditorSchedule"}),_l=f({__name:"schedule",props:{taskId:{}},setup(a){const e=ye(()=>L.get(a.taskId),L.tryGet(a.taskId)??Te.create()),{setPageLayout:n}=be(),o=le({taskId:()=>a.taskId,page:"schedule"});return _e(()=>{n(()=>({cmpHeader:{cmp:ae,bind:{task:e.value,path:a.taskId}},cmpFooter:null,menuItems:o}))}),(l,t)=>(v(),x(i(pl),{modelValue:i(e).schedule,"onUpdate:modelValue":t[0]||(t[0]=u=>i(e).schedule=u),class:"py-1"},null,8,["modelValue"]))}});export{_l as default};
